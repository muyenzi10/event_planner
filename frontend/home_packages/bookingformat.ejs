<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wedding Planner - Bookings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
 <style> body {font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;
 background:#f9f9f9;margin:0;} 
 .navbar {background:linear-gradient(90deg,#6a11cb,#2575fc);} 
 .navbar-brand,.navbar-nav .nav-link {color:#ffffff!important;} 
 .sidebar {width:240px;background:linear-gradient(180deg,#6a11cb,#2575fc);color:#fff;min-height:100vh;position:fixed;top:56px;left:0;padding-top:20px;} 
 /* Sidebar link base */
.nav-link {
    position: relative;
    padding: 12px 20px;
    color: #fff;
    text-decoration: none;
    display: flex;
    align-items: center;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
}

/* Hover & Active Effect */
.nav-link:hover,
.nav-link.active {
    background: rgba(255, 255, 255, 0.15);
    transform: translateX(5px);
    border-left-color: #0e7ee7;
    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
}

/* Optional: Sliding border using ::before for extra smoothness */
.nav-link::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 0;
    background-color: #0e7ee7;
    border-radius: 0 4px 4px 0;
    transition: width 0.3s ease;
}

.nav-link:hover::before,
.nav-link.active::before {
    width: 4px;
}

/* Sidebar main content spacing */
.main-content {
    margin-left: 240px;
    margin-top: 56px;
    padding: 30px;
    transition: margin-left 0.3s ease;
}


 .main-content {margin-left:240px;margin-top:56px;padding:30px;} 
 .table-container {background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.05);padding:20px;overflow-x:auto;} 
 .table thead th {background:linear-gradient(to bottom,#f8f9fa,#e9ecef);color:#2c3e50;font-weight:700;} 
 .table tbody tr:hover {background:#f9f9ff;transition:0.3s;} 
 .pagination .page-item.active .page-link {background-color:#2575fc;border-color:#2575fc;}
  </style>
 
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <button class="btn btn-outline-light me-3" id="sidebarToggle"><i class="fas fa-bars"></i></button>
      <a class="navbar-brand" href="#"><i class="fas fa-heart"></i> Wedding Planner</a>
    </div>
  </nav>

  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header text-center"><h2>Menu</h2></div>
    <div class="nav-links">
      
       <a href="/Dashboard/view/supliers" class="nav-link active">
          <i class="fas fa-users"></i> Suppliers
        </a>
      <a href="/Dashboard/booking" class="nav-link active"><i class="fas fa-bookmark"></i> Bookings</a>
    </div>
  </nav>

  <!-- Main -->
  <main class="main-content">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="fas fa-users"></i> All Bookings</h1>
    </div>

    <!-- Search & Reset -->
    <form class="d-flex flex-wrap align-items-center gap-2 mb-4" method="GET" action="/Dashboard/booking">
      <input type="text" class="form-control" name="name" placeholder="Search by name"
             value="<%= query.name || '' %>" style="width:250px;">
      <button type="submit" class="btn btn-success px-4">Filter</button>
      <a href="/Dashboard/booking" class="btn btn-secondary px-4">Reset</a>
    </form>
<!-- Bookings Table -->
<div class="table-container">
  <table class="table table-hover align-middle">
    <thead>
      <tr>
        <th>Couple</th>
        <th>Contact</th>
        <th>Date</th>
        <th>Guests</th>
        <th>Style</th>
        <th>Location</th>
        <th>comments</th>
        <th class="text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% bookings.forEach(booking => { %>
        <tr>
          <td><%= booking.firstname %> <%= booking.lastname %></td>
          <td><%= booking.email %><br><%= booking.phone %></td>
          <td><%= new Date(booking.weddingDate).toDateString() %></td>
          <td><%= booking.guestsNumber %></td>
          <td><%= booking.weddingType %></td>
          <td><%= booking.weddingLocation %></td>
          <td><%= booking.weddingVision || 'No notes' %></td>
          <td class="text-center">
            <a href="/Dashboard/booking/edit/<%= booking._id %>" class="btn btn-sm btn-outline-warning">
              <i class="fas fa-pen"></i>
            </a>
            <form action="/Dashboard/booking/delete/<%= booking._id %>?_method=DELETE"
                  method="POST" style="display:inline;" 
                  onsubmit="return confirm('Delete this booking?');">
              <button type="submit" class="btn btn-sm btn-outline-danger"><i class="fas fa-trash"></i></button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

    
          
    <!-- Pagination -->
    <div class="d-flex justify-content-between align-items-center mt-3">
      <div class="text-muted">
        Showing <%= ((currentPage - 1) * limit) + 1 %>
        to <%= Math.min(currentPage * limit, totalBookings) %>
        of <%= totalBookings %>
      </div>
      <nav>
        <ul class="pagination mb-0">
          <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
            <a class="page-link"
               href="/Dashboard/booking?page=<%= currentPage - 1 %>&limit=<%= limit %><%= query.name ? '&name=' + query.name : '' %>">
               <i class="fas fa-chevron-left"></i></a>
          </li>
          <% for (let i = 1; i <= totalPages; i++) { %>
            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
              <a class="page-link"
                 href="/Dashboard/booking?page=<%= i %>&limit=<%= limit %><%= query.name ? '&name=' + query.name : '' %>"><%= i %></a>
            </li>
          <% } %>
          <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
            <a class="page-link"
               href="/Dashboard/booking?page=<%= currentPage + 1 %>&limit=<%= limit %><%= query.name ? '&name=' + query.name : '' %>">
               <i class="fas fa-chevron-right"></i></a>
          </li>
        </ul>
      </nav>
    </div>
  </main>

  <script>
    document.getElementById('sidebarToggle').addEventListener('click',()=>{
      const s=document.getElementById('sidebar');const m=document.querySelector('.main-content');
      if(s.style.marginLeft==='-240px'){s.style.marginLeft='0';m.style.marginLeft='240px';}
      else{s.style.marginLeft='-240px';m.style.marginLeft='0';}
    });
  </script>
</body>
</html>
