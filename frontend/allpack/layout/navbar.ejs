<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
  <div class="container">

    <!-- Brand -->
    <a class="navbar-brand" href="#">
      <i class="fas fa-heart me-2"></i>Dream Day
    </a>

    <!-- Hamburger (open) -->
    <button class="navbar-toggler custom-toggler" type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation">
      <div class="hamburger-icon">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </button>

    <!-- COLLAPSIBLE MENU -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link <%= activePage === 'home' ? 'active' : '' %>" href="/home">
            <i class="fas fa-home me-1"></i> Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= activePage === 'about' ? 'active' : '' %>" href="/about">
            <i class="fas fa-info-circle me-1"></i> About
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= activePage === 'packages' ? 'active' : '' %>" href="/packages">
            <i class="fas fa-gift me-1"></i> Packages
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= activePage === 'suppliers' ? 'active' : '' %>" href="/suppliers">
            <i class="fas fa-camera me-1"></i> Suppliers
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link <%= activePage === 'booking' ? 'active' : '' %>" href="/booking">
            <i class="fas fa-bookmark me-1"></i> Book Consultation
          </a>
        </li>
      </ul>
    </div>

    <!-- CLOSE BUTTON (mobile only) -->
    <button class="navbar-close-btn d-lg-none"
        type="button"
        aria-label="Close">
        <i class="fas fa-times"></i>
    </button>

  </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var navbarCollapse = document.getElementById('navbarNav');
    var body = document.body;
    var navLinks = document.querySelectorAll('.nav-link');
    var closeBtn = document.querySelector('.navbar-close-btn');
    var hamburgerBtn = document.querySelector('.navbar-toggler');
    var navbar = document.querySelector('.navbar');

    // Initialize Bootstrap Collapse
    var bsCollapse = new bootstrap.Collapse(navbarCollapse, {
        toggle: false
    });

    // Add / remove menu-open class
    navbarCollapse.addEventListener('show.bs.collapse', function () {
        body.classList.add('menu-open');
        // Show close button, hide hamburger
        if (closeBtn) closeBtn.style.display = 'block';
        if (hamburgerBtn) hamburgerBtn.style.display = 'none';
    });

    navbarCollapse.addEventListener('hide.bs.collapse', function () {
        body.classList.remove('menu-open');
        // Hide close button, show hamburger
        if (closeBtn) closeBtn.style.display = 'none';
        if (hamburgerBtn) hamburgerBtn.style.display = 'block';
        
        navbarCollapse.querySelectorAll('.nav-item').forEach(function(item) {
            item.style.opacity = '1';
            item.style.animation = 'none';
        });
    });

    // Close menu on nav-link click (mobile only)
    navLinks.forEach(function(link) {
        link.addEventListener('click', function() {
            if (window.innerWidth < 992) {
                bsCollapse.hide();
            }
        });
    });

    // Close menu on close button click
    if(closeBtn) {
        closeBtn.addEventListener('click', function() {
            bsCollapse.hide();
        });
        
        // Initially hide the close button
        closeBtn.style.display = 'none';
    }

    // Close menu when clicking outside (only on mobile)
    document.addEventListener('click', function(event) {
        // Check if menu is open on mobile
        if (window.innerWidth < 992 && navbarCollapse.classList.contains('show')) {
            // Check if click is outside the navbar
            var isClickInsideNavbar = navbar.contains(event.target);
            var isClickOnHamburger = hamburgerBtn && hamburgerBtn.contains(event.target);
            var isClickOnCloseBtn = closeBtn && closeBtn.contains(event.target);
            
            // If click is outside navbar and not on hamburger/close button, close menu
            if (!isClickInsideNavbar && !isClickOnHamburger && !isClickOnCloseBtn) {
                bsCollapse.hide();
            }
        }
    });

    // Handle resize
    window.addEventListener('resize', function() {
        if (window.innerWidth >= 992) {
            body.classList.remove('menu-open');
            // Reset button states on desktop
            if (closeBtn) closeBtn.style.display = 'none';
            if (hamburgerBtn) hamburgerBtn.style.display = 'block';
        } else {
            // On mobile, check if menu is open
            if (navbarCollapse.classList.contains('show')) {
                if (closeBtn) closeBtn.style.display = 'block';
                if (hamburgerBtn) hamburgerBtn.style.display = 'none';
            } else {
                if (closeBtn) closeBtn.style.display = 'none';
                if (hamburgerBtn) hamburgerBtn.style.display = 'block';
            }
        }
    });
});
</script>